# Yoach 1 - 功能说明

**目的：** 本文档从用户和测试的角度说明Yoach 1设备的功能，详细描述每种操作模式和用户可配置的参数。

**目标受众：** 测试人员、iOS开发人员、产品经理、支持团队、市场营销人员。

---

## 目录

- [Yoach 1 - 功能说明](#yoach-1---功能说明)
  - [目录](#目录)
  - [概述](#概述)
  - [操作模式](#操作模式)
    - [1. MANUAL_MODE](#1-manual_mode)
    - [2. RANDOM_MODE](#2-random_mode)
    - [3. TIMED_MODE](#3-timed_mode)
    - [4. DOUBLE_MODE](#4-double_mode)
    - [5. RHYTHM_MODE](#5-rhythm_mode)
    - [6. CONFIG_MODE](#6-config_mode)
    - [7. OPENING_MODE](#7-opening_mode)
    - [8. CLOSING_MODE](#8-closing_mode)
    * [9. TERMINATE_MODE](#9-terminate_mode)
    * [10. PROCESSED_MODE](#10-processed_mode-占位符名称-待澄清)
  - [关键参数（通过蓝牙在CONFIG_MODE中用户可配置）](#关键参数通过蓝牙在config_mode中用户可配置)

## 概述

Yoach 1是一款交互式设备，利用传感器（飞行时间传感器和毫米波雷达）和反馈机制（RGB LED和蜂鸣器）根据用户交互和可配置的游戏模式创造吸引人的体验。控制和配置主要通过低功耗蓝牙（BLE）管理。

---

## 操作模式

设备在多个不同的模式下运行，每个模式由特定的BLE命令触发，提供不同的交互行为。

### 1. MANUAL_MODE

*   **激活方式：** 通过BLE命令（例如：`CMD_SET_MODE_MANUAL`）。
*   **行为：**
    *   进入时，设备可能执行基线传感器校准（例如：TF-Luna获取距离读数）。
    *   RGB LED灯条根据配置的设置（颜色、亮度）点亮。
    *   主传感器（可配置，例如：TF-Luna）主动扫描检测范围内的物体或交互。
*   **传感器检测：** 根据选定的传感器（`sensorMode`参数）检测存在或运动。对于TF-Luna，通常是跨越距离阈值。对于毫米波，可能是检测运动信号。
*   **动作完成/触发：** 当有效检测发生时（例如：物体跨越传感器阈值）：
    *   设备提供反馈：LED模式改变（例如：闪烁特定颜色），蜂鸣器短暂发声。
    *   可能通过BLE发送确认消息。
*   **反馈：** 视觉反馈（LED灯）、听觉反馈（蜂鸣器）。

### 2. RANDOM_MODE

*   **激活方式：** 通过BLE命令（例如：`CMD_SET_MODE_RANDOM`）。
*   **行为：**
    *   类似于手动模式，但设备可能在初始化后引入随机延迟或变化，以调整何时"激活"进行检测。
    *   LED亮起，可能带有初始的"等待"模式。
    *   传感器激活以进行检测。
*   **传感器检测：** 功能类似于手动模式，基于`sensorMode`。
*   **动作完成/触发：** 检测发生时：
    *   提供反馈（LED闪烁，蜂鸣器发声）。
    *   设备可能自动过渡回等待状态或需要重置命令。
*   **反馈：** 视觉反馈（LED灯）、听觉反馈（蜂鸣器）。

### 3. TIMED_MODE

*   **激活方式：** 通过BLE命令（例如：`CMD_SET_MODE_TIMED`）。
*   **行为：**
    *   此模式可能涉及在特定时间窗口内的挑战或交互。
    *   LED可能指示活跃的时间窗口（例如：倒计时模式、颜色变化）。
    *   传感器仅在这些时间窗口内活跃。持续时间可能由`timedBreak`控制。
*   **传感器检测：** 仅在计时器活跃时检测交互。
*   **动作完成/触发：** 如果在允许的时间内发生检测：
    *   积极反馈（例如：绿色闪烁、愉快的声音）。
    *   如果在计时器过期前未发生检测：消极反馈（例如：红色闪烁、不同的声音）或仅重置。
*   **反馈：** 视觉反馈（LED用于计时和成功/失败指示）、听觉反馈（蜂鸣器）。

### 4. DOUBLE_MODE

*   **激活方式：** 通过BLE命令（例如：`CMD_SET_MODE_DOUBLE`）。
*   **行为：**
    *   此模式可能需要在特定时间范围或序列内进行两次不同的传感器检测。
    *   它可能利用TF-Luna和毫米波传感器，或需要来自同一传感器的两次触发。
    *   LED可能指示状态（例如：等待第一次检测、等待第二次检测）。
*   **传感器检测：** 根据模式的逻辑需要两个有效的检测事件。
*   **动作完成/触发：** 成功检测到两个所需事件后：
    *   特定的成功反馈（例如：独特的LED模式/颜色、声音）。
*   **反馈：** 视觉反馈（指示序列状态的LED灯）、听觉反馈（蜂鸣器）。

### 5. RHYTHM_MODE

*   **激活方式：** 通过BLE命令（例如：`CMD_SET_MODE_RHYTHM`）。
*   **行为：**
    *   专注于计时和序列。设备可能呈现光/声音提示的模式。
    *   用户需要与传感器同步交互以跟随提示。
    *   LED显示节奏模式；蜂鸣器可能提供听觉提示。
*   **传感器检测：** 检测交互并将其计时与预期的节奏进行比较。
*   **动作完成/触发：**
    *   成功的节奏交互：积极反馈。
    *   错过时机或不正确的交互：消极反馈。
*   **反馈：** 视觉反馈（LED模式用于提示和反馈）、听觉反馈（蜂鸣器用于提示和反馈）。

### 6. CONFIG_MODE

*   **激活方式：** 通过BLE命令（例如：`CMD_SET_MODE_CONFIG`）。
*   **行为：**
    *   一种非交互模式，主要用于设备设置。
    *   允许通过BLE命令设置配置参数（如`blinkBreak`、`timedBreak`、`buzzerTime`、`sensorMode`、LED颜色/亮度）。
    *   LED可能显示特定的颜色（例如：蓝色）来指示它处于配置模式。传感器通常处于非活跃状态。
*   **传感器检测：** 不适用。
*   **动作完成/触发：** 配置参数在接收到有效的BLE命令时更新。设备可能发送返回确认。
*   **反馈：** 最小反馈，可能是LED状态颜色。BLE确认消息。

### 7. OPENING_MODE

*   **激活方式：** 可能在设备上电时或通过特定的重置/启动命令自动激活。
*   **行为：**
    *   代表初始启动序列。
    *   执行自检，初始化外设（传感器、LED、蓝牙）。
    *   可能显示特定的LED模式（例如：彩虹扫过）并播放启动声音。
    *   过渡到默认模式（例如：手动或配置模式）或等待命令。
*   **传感器检测：** 通常在打开期间不活跃。
*   **动作完成/触发：** 完成初始化并过渡到另一个模式。
*   **反馈：** 视觉反馈（启动LED模式）、听觉反馈（启动声音）。

### 8. CLOSING_MODE

*   **激活方式：** 通过关闭或特定的BLE命令激活（例如：`CMD_SHUTDOWN`）。
*   **行为：**
    *   执行必要的清理操作（例如：保存状态（如果适用）、优雅关闭外设）。
    *   可能显示关闭LED模式或声音。
    *   为设备的低功耗状态或关闭做准备。
*   **传感器检测：** 不活跃。
*   **动作完成/触发：** 设备关闭或进入深度睡眠状态。
*   **反馈：** 视觉反馈（关闭LED模式）、听觉反馈（关闭声音）。

### 9. TERMINATE_MODE

*   **激活方式：** 可能由特定的错误条件、手动重置或专门的BLE命令（例如：`CMD_TERMINATE`）触发。
*   **行为：**
    *   一种安全或停止状态。立即停止所有活动进程和任务。
    *   关闭输出（LED、蜂鸣器）。
    *   可能需要电源循环或特定的重置命令才能退出。
*   **传感器检测：** 不活跃。
*   **动作完成/触发：** 设备停止运行。
*   **反馈：** 输出关闭。如果可能，可能记录错误消息。

### 10. PROCESSED_MODE

*   **激活方式：** 该名称暗示这可能是一个内部状态或在特定数据处理后触发的模式。需要来自固件实现的更多背景信息。（例如：`CMD_SET_MODE_PROCESSED`或内部过渡）。
*   **行为：** 可能涉及显示结果、在复杂任务后等待用户确认或处理交互后逻辑。
*   **传感器检测：** 取决于具体用途。
*   **动作完成/触发：** 取决于具体用途。
*   **反馈：** 取决于具体用途。

---

## 关键参数（通过蓝牙在CONFIG_MODE中用户可配置）

这些参数允许自定义设备的行为：

*   **`blinkBreak` (ms)：** 可能定义某些LED模式中的闪烁持续时间或闪烁之间的关闭时间（例如：反馈信号）。*用户影响：* 影响反馈闪烁的视觉速度/样式。
*   **`timedBreak` (ms)：** 可能设置`TIMED_MODE`中活跃时间窗口的持续时间，或可能是其他模式中检测之间的冷却期。*用户影响：* 定义挑战持续时间或交互频率。
*   **`buzzerTime` (ms)：** 控制蜂鸣器对反馈事件发声的持续时间。*用户影响：* 改变听觉反馈信号的长度。
*   **`sensorMode`：** 选择要使用的主传感器或检测逻辑。示例：
    *   `0`：使用TF-Luna（飞行时间）传感器，基于距离阈值。
    *   `1`：使用毫米波（雷达）传感器，基于运动检测。
    *   `2`：以特定方式使用两个传感器（例如：用于`DOUBLE_MODE`）。
    *   *用户影响：* 决定设备如何检测交互（距离与运动）。
*   **LED颜色/亮度：** RGB LED灯条默认颜色和总体亮度的可配置参数。*用户影响：* 自定义设备的视觉外观和强度。
*   **传感器灵敏度/阈值：** 高级参数（可能也可能不向用户公开），用于微调传感器检测（例如：TF-Luna的距离阈值、毫米波的运动灵敏度）。*用户影响：* 调整设备对交互的触发难度。

---

*注意：具体的BLE命令名称和参数范围取决于固件实现。*
